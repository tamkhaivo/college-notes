# Database Management Systems

Normalization (1 - 5 Levels)

Read and Write Databases

2 sets of databases which will compute and update later on or else the compute lenthency will be high

## Types

Varchar2(10) - Variable Length
Char(10) - Fixed Length
Truncate - Fast Unrecoverable Deletion of Data (Some Data is still in memory)
Delete - Slow Recoverable Deletion of Data

## Useful Commands

CREATE TABLE patient (
patient_id NUMBER,
fname VARCHAR(10),
lname VARCHAR(10)
);

### Primary Key

1. Creating a composite primary key without a constraint name.

- ALTER TABLE patient ADD PRIMARY KEY (fname, lname);

2. Can create a primary key using alter table statement.

- ALTER TABLE patient ADD PRIMARY KEY (patient_id);

3. Add a constraint name

- ALTER TABLE patient ADD CONSTRAINT patient_patient_id_pk PRIMARY KEY (patient_id);

4. Instead of adding, modify can be used as well.

- ALTER TABLE patient MODIFY patient_id PRIMARY KEY;
- ALTER TABLE patient MODIFY patient_id CHAR PRIMARY KEY;
- ALTER TABLE patient MODIFY patient_id CONSTRAINT patient_patient_id_pk PRIMARY KEY;

## Examples

### Name - Age - Address - Disease1 - Disease2 - Disease 3

1. Patient

- PatientID - Name - Age - AddressID

2. Disease

- DiseaseID - Disease

3.  Address

- AddressID - Address

4. Patient Disease

- PatientID - DiseaseID
  Student - Religion - Eth1 - Eth2

### StudentID - FirstName - LastName - ReligionID

1. Religion

- ReligionID - ReligionName

2. Ethnicity

- EthnicityID - EthnicityName

3. Student Ethnicity

- StudentID - EthnicityID

Marrage

PersonID - First Name - Last Name - MarriedID
vs
PersonID - First Name - Last Name - PartnerID(PersonID (FK))

### Column Level Primary Key

select constraint_name, constraint_type, table_name, status from user_constraints;
where table_name = 'PATIENT'; // Case Sensitive when querying

create table patient (
patient_id NUMBER constraint paitent_id_pk primary key,
fname VARCHAR(10),
lname VARCHAR(10)
);

### Table Level Primary Key

create table patient (
patient_id NUMBER,
fname VARCHAR(10),
lname VARCHAR(10),
constraint patient_lnamefname_pk primary key (fname, lname)
);

#### Add Primary Keys to Existing Tables

create table patient (
patient_id NUMBER,
fname VARCHAR(10),
lname VARCHAR(10),
);

1. Column Level
   alter table patient modify patient_id primary key
   constraint patient_pk unique

   alter table patient modify fname not null

   alter table patient disable constraint patient_pk
   alter table patient disable primary key

   alter talbe
   alter table patient enable constraint patient_pk

2. Table Level (Composite Key) - Cannot create a not null constraint at the table level
   alter table patient add primary key (fname, lname)

### Why would we wna tto disable primary key

1. Creating a copy of table to then enable primary key because with every entry there will check for duplication

### Parameters

#### Table Level

1. create table patient (
   patient_id NUMBER,
   fname VARCHAR(10) unique,
   lname VARCHAR(10) not null,
   salary NUMBER check (salary > 100)
   );

select constraint_name, constraint_type, table_name, status, search_condition from user_constraints;

| constraint type | meaning     |
| --------------- | ----------- |
| c               | check       |
| p               | primary key |
| u               | unique      |
| r               | references  |

#### Column Level

1. create table patient (
   patient_id NUMBER,
   fname VARCHAR(10),
   lname VARCHAR(10),
   salary NUMBER,
   check (salary > 100)
   );

##### Checkpoint 3

drop table patient;
drop table person;

create table person (
person_id number primary key,
SSN char(9),
lname varchar(10),
salary number,
dob date,
constraint unique_key unique(SSN)
);

alter table person modify dob not null;

insert into person values (1,'123456789', 'Tww', 100, '04 Feb 2025');

alter table person modify salary check (salary > 100); // Column Level

#### Foriegn Key

drop table patient_disease;
drop table patient;
drop table disease;

create table patient (
patient_id number primary key,
height number,
fname varchar(10),
lname varchar(10)
);

create table disease (
disease_id number primary key,
disease_name varchar(10)
);

create table patient_disease (
patient_id number references constraint patient_patient_id_fk patient(patient_id),
disease_id number,
primary key(patient_id, disease_id),
constraint patient_disease_disease_id_fk foreign key (disease_id) references disease(disease_id)
);

1. Column Level
   alter table patient_disease modify patient_id references constraint patient_patient_id_fk patient(patient_id),

2. Table Level
   alter table patient_disease add constraint patient_disease_disease_id_fk foreign key (disease_id) references disease(disease_id)

### Deletion

on concasade delete

#### Esample

// Column Level
create table Person (
person_id number constraint person_id_pk primary key,
fname varchar(10),
lname varchar(10),
personality_id number constraint personality_id_fk references personality(personality_id)

);

// Table Level
create table Person (
person_id number,
fname varchar(10),
lname varchar(10),
personality_id number,
primary key(person_id),
foreign key(personality_id) references personality(personality_id)
);

// Column Level
create table Personality (
personality_id number constraint personality_id_pk primary key,
personality_name varchar(20)
)

// Table Level
create table Personality (
personality_id number,
personality_name varchar(20),
primary key(personality_id)
)

insert into Personality values (1, 'Aggressive');
insert into Person values (1, 'John', 'Doe', 1);

ALTER TABLE person MODIFY person_id CONSTRAINT person_id_pk PRIMARY KEY;
ALTER TABLE person ADD CONSTRAINT person_id_pk PRIMARY KEY(person_id);

ALTER TABLE person MODIFY personality_id CONSTRAINT personality_id_fk REFERENCES personality; // Column Level
ALTER TABLE person ADD CONSTRAINT personality_id_fk FORIEGN KEY(personality_id) REFERENCES personality;

desc user_indexes;

insert into date_test values (to_date('july 01 1990 12:12:00 AM', 'month dd yyyy hh:mi:ss AM'));
alter session set nls_date_format = 'MON-DD-YY HH24:MI:SS'

### Sequences

Generated auto Primary Keys

select sysdate from dual;

find the next value from my sequence -- Dual table is the dummy table

currval vs nextval

- nextval increments every call
- currval doesnt

### Individual Work

drop table vo_candidate;
drop table vo_party;

create table vo_candidate (
fname varchar(20),
lname varchar(20),
DOB date,
salary number
);

create table vo_party(
partydesc varchar(20)
);

alter table vo_candidate drop column DOB;
alter table vo_candidate add DOB date;

alter table vo_candidate add canidate_id number;
alter table vo_candidate add constraint vo_canidate_id_pk primary key (canidate_id);

alter table vo_party add party_id number;
alter table vo_party add constraint vo_party_id_pk primary key (party_id);

alter table vo_candidate drop constraint vo_canidate_id_pk;
alter table vo_candidate add constraint vo_canidate_id_pk primary key (fname, lname);

drop table vo_party;
create table vo_party(
partyID number constraint PK_vo_party primary key,
partydesc varchar(20)
);

alter table vo_candidate add constraint CK_vo_candidate_salary
check (10000 < salary and salary < 50000);

alter table vo_party modify partydesc varchar(20) not null;

alter table vo_candidate disable constraint CK_vo_candidate_salary;

alter table vo_candidate add partyID number(10);
alter table vo_candidate add constraint FK_vo_candidate_party
foreign key (partyID) references vo_party;

DESCRIBE vo_candidate;

select constraint_name, status, constraint_type, r_constraint_name
from user_constraints
where table_name = 'VO_CANDIDATE';

alter table vo_candidate disable constraint FK_VO_CANDIDATE_PARTY;

alter table vo_candidate drop constraint FK_VO_CANDIDATE_PARTY;

## Modelling

1. Conceptual

- Entity

2. Relational

- Relations - 1 to 1, 1 to M, M to N
- Relationship Occurance Diagram
  -- 3 Ellipses
  -- DoubleLine is Full Partifpication
  -- SingleLine is Partial Partipication
  -- Degree - Unary, Binary, Ternary, Nary(many)
  --

  > o max - a person 1 personality but a personality can have at most Many, but min 0
  > || - 1 Person can be associated with at MAX 1 Personality (MAX) vs 1 person can be associated with a MINIMUM 1 personality(MIN)

- Tuples
- Weak Entity (Supported by Another Table w/Primary Key)
- Strong Entity (Supported by its own Primary Key)

3. Physical

- Tables
- PK
- FK
- Rows

Fan Trap vs Cashm Trap

X closure {X}+ vs F Closure {F}+
Superkey -

Armstrpmgs Axoims

- Reflecivity: Y -> X then X -> Y
- Augmentation: X -> Y then XZ -> YZ
- Transitivity: X -> Y then Y -> Z then X -> Z

Inference Rules
UNion
Decompositoin
Pseudotransivity
Composition

USED FOR SIMPLIFICATION --> Keep Singleton Associations from Left to Right

ABC -> D
AB -> C
BC -> A
B -> A
A -> C

?
ABC -> D

BC =
ABCD

C =
C

### Unique

Display the contens of Person Table - use the Alias Last Name"
Select lname as "Last Name" from person;

Concat first name, last name, and salary seperated by space
Concat(fname, ' ', lname, ' ', salary) from Person;

### Dual Table

Select INITCAP(fname) from Person;
Select UPPER(lname) from Person;
Select Substr('this is a test', 6, 2) from dual; Start from 6 extract 2 chars
Select Replace('000123', '0') from DUAL; == '123'

fname = 'Bond, James'

Select substr(fname, 1, instr(fname,',') - 1) from patient
`
select
trim(substr(fname, 1, instr(fname, ',')-1)) || ' ' ||
trim(substr(fname, instr(fname, ',')+2))
from patient;

`

round(12.12, 1) = 12
trunc(12.12) = 12
ceil(12.12) = 13
floor(12.12) = 12
mod()
Greatest()
LEAST()

nvl(tochar(salary), 'loser') == if null value then display loser, same column type
nvl2(tochar(salary), tochar(salary), 'winner') ; if value is non null then display winner
select fname, decode(salary, null, 'loser', salary) from patient; if salary is null then 'loser' else display salary
`select fname,
   decode(sign(salary-40000), null, 'no data',
   0, 'okay',
   -1, 'good job',
   1, 'god help',
   null, ) from patient; if salary is greater than 40_000 then 'no data' else display salary
`  

`
 select fname, 
 CASE
 

select fname from patient
where salary > 40000;

Fuzzy searches 
SELECT fname, FROM patient WHERE city LIKE 'D%';


sign(1) = 1
sign(0) = 0
sign(-1) = -1
sign(null) = null

- Sysdate
-
